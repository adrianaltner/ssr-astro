---
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogPostMeta from '../components/BlogPostMeta.astro';
import { Image } from 'astro:assets';
import { getReadingTime } from '../utils/readingTime';

interface Props {
  data: CollectionEntry<'blog'>['data'];
  content: string;
}

const { data, content } = Astro.props;
const { 
  title, 
  description, 
  pubDate, 
  updatedDate, 
  heroImage, 
  tags,
  category
} = data;

// Calculate reading time
const readingTime = getReadingTime(content);
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
		<style>
			/* Container styles */
			main {
				width: 100%;
				margin: 0;
				padding-top: 0;
			}
			
			/* Hero image styling */
			.hero-banner {
				position: relative;
				width: 100%;
				max-height: 500px;
				overflow: hidden;
				margin-bottom: 2rem;
			}
			
			.hero-banner img {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}
			
			.with-overlay {
				position: relative;
			}
			
			.with-overlay::after {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.6) 100%);
			}
			
			.hero-content {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				padding: 2rem;
				color: white;
				z-index: 10;
			}
			
			.hero-title {
				font-size: 2.5rem;
				margin: 0;
				line-height: 1.2;
				text-shadow: 0 2px 4px rgba(0,0,0,0.3);
			}
			
			/* Article content */
			.container {
				max-width: 800px;
				margin: 0 auto;
				padding: 0 1.5rem 3rem;
			}
			
			.article-header {
				margin-bottom: 2rem;
			}
			
			.article-title {
				font-size: 2.5rem;
				margin: 0 0 1rem 0;
				line-height: 1.2;
			}
			
			hr.divider {
				border: 0;
				height: 1px;
				background: rgba(var(--gray), 0.2);
				margin: 2rem 0;
			}
			
			/* Article body styling */
			.content {
				font-family: 'Atkinson', sans-serif;
				font-size: 1.1rem;
				line-height: 1.7;
				color: rgb(var(--gray-dark));
			}
			
			/* Hide the article title if we're using the hero banner title */
			.has-hero .article-title {
				display: none;
			}
			
			/* Mobile adjustments */
			@media (max-width: 768px) {
				.hero-banner {
					max-height: 300px;
				}
				
				.hero-title {
					font-size: 1.8rem;
				}
				
				.article-title {
					font-size: 1.8rem;
				}
				
				.content {
					font-size: 1rem;
				}
			}
		</style>
	</head>

	<body>
		<Header />
		<main>
			<article>
				{heroImage ? (
					<div class="hero-banner with-overlay">
						<Image 
							width={1200} 
							height={600} 
							src={heroImage} 
							alt={title}
							quality={90}
						/>
						<div class="hero-content">
							<h1 class="hero-title">{title}</h1>
						</div>
					</div>
				) : null}
				
				<div class="container">
					<header class={`article-header ${heroImage ? 'has-hero' : ''}`}>
						<h1 class="article-title">{title}</h1>
						<BlogPostMeta 
							pubDate={pubDate}
							updatedDate={updatedDate}
							category={category}
							tags={tags}
							readingTime={readingTime}
						/>
						<hr class="divider" />
					</header>
					
					<div class="content">
						<slot />
					</div>
				</div>
			</article>
		</main>
		<Footer />
	</body>
</html>
